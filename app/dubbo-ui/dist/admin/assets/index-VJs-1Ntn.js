import{d as w,v as b,a as D,r as N,W as T,D as E,c as _,b as I,w as l,n as p,P as R,F as O,R as q,e as v,o,X as V,j as A,I as L,f as c,t as m,Q as u,G as y,a1 as P,a2 as $,J as B,K as F,y as M,_ as Y}from"./index-hmLAZQYT.js";import{s as U}from"./instance-9-P3Wy8N.js";import{S as G,a as H,s as r}from"./SearchUtil-sOWd6ofa.js";import{p as J,q as f}from"./PromQueryUtil-2EbGMcmH.js";import{b as K}from"./ByteUtil-YdHlSEeW.js";import"./request-8jI_GZey.js";const Q={class:"instances-container"},X=["onClick"],j=w({__name:"index",setup(W){b(e=>({"2ab83322":p(R)}));let C=D(),g=C.query.query,S=[{title:"instanceDomain.instanceIP",key:"ip",dataIndex:"ip",sorter:(e,t)=>r(e.ip,t.ip),width:200},{title:"instanceDomain.instanceName",key:"name",dataIndex:"name",sorter:(e,t)=>r(e.name,t.name),width:140},{title:"instanceDomain.deployState",key:"deployState",dataIndex:"deployState",width:120,sorter:(e,t)=>r(e.deployState,t.deployState)},{title:"instanceDomain.deployCluster",key:"deployCluster",dataIndex:"deployCluster",sorter:(e,t)=>r(e.deployCluster,t.deployCluster),width:120},{title:"instanceDomain.registerState",key:"registerState",dataIndex:"registerState",sorter:(e,t)=>r(e.registerState,t.registerState),width:120},{title:"instanceDomain.registerCluster",key:"registerClusters",dataIndex:"registerClusters",sorter:(e,t)=>r(e.registerClusters,t.registerClusters),width:140},{title:"instanceDomain.CPU",key:"cpu",dataIndex:"cpu",sorter:(e,t)=>r(e.cpu,t.cpu),width:140},{title:"instanceDomain.memory",key:"memory",dataIndex:"memory",sorter:(e,t)=>r(e.memory,t.memory),width:100},{title:"instanceDomain.startTime_k8s",key:"startTime_k8s",dataIndex:"startTime",sorter:(e,t)=>r(e.startTime,t.startTime),width:200}];function x(e){return U(e).then(async t=>J(t,["cpu","memory"],async s=>{let a=s.ip.split(":")[0],i=await f(`sum(node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate{container!=""}) by (pod) * on (pod) group_left(pod_ip)
        kube_pod_info{pod_ip="${a}"}`),h=await f(`sum(container_memory_working_set_bytes{container!=""}) by (pod)
* on (pod) group_left(pod_ip)
kube_pod_info{pod_ip="${a}"}`);s.cpu=O.isNumber(i)?i.toFixed(3)+"u":i,s.memory=K(h)}))}const n=N(new G([{label:"appName",param:"keywords",defaultValue:g,placeholder:"typeAppName",style:{width:"200px"}}],x,S));return T(()=>{n.tableStyle={scrollX:"100",scrollY:"367px"},n.onSearch()}),q(M.SEARCH_DOMAIN,n),E(C,(e,t)=>{n.queryForm.keywords=e.query.query,n.onSearch(),console.log(e)}),(e,t)=>{const s=v("a-tag");return o(),_("div",Q,[I(H,{"search-domain":n},{bodyCell:l(({text:a,record:i,index:h,column:d})=>[d.dataIndex==="ip"?(o(),_("span",{key:0,class:"app-link",onClick:k=>p(V).push(`/resources/instances/detail/${i.name}/${i[d.key]}`)},[A("b",null,[I(p(L),{style:{"margin-bottom":"-2px"},icon:"material-symbols:attach-file-rounded"}),c(" "+m(a),1)])],8,X)):u("",!0),d.dataIndex==="deployState"?(o(),y(s,{key:1,color:p(P)[a.toUpperCase()]},{default:l(()=>[c(m(a),1)]),_:2},1032,["color"])):u("",!0),d.dataIndex==="deployCluster"?(o(),y(s,{key:2,color:"grey"},{default:l(()=>[c(m(a),1)]),_:2},1024)):u("",!0),d.dataIndex==="registerState"?(o(),y(s,{key:3,color:p($)[a.toUpperCase()]},{default:l(()=>[c(m(a),1)]),_:2},1032,["color"])):u("",!0),d.dataIndex==="registerClusters"?(o(!0),_(B,{key:4},F(a,k=>(o(),y(s,{color:"grey"},{default:l(()=>[c(m(k),1)]),_:2},1024))),256)):u("",!0)]),_:1},8,["search-domain"])])}}}),se=Y(j,[["__scopeId","data-v-2f938e3f"]]);export{se as default};
