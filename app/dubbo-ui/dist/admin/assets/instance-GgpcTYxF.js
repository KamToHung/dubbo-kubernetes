import{d as $,v as M,a as B,u as Y,r as x,W as S,c as I,b as d,w as t,e as y,n as r,P as g,F as j,R as F,o as a,J as h,K as D,G as l,I as v,f as n,t as o,j as q,Q as c,a1 as G,a2 as H,y as J,_ as K}from"./index-hmLAZQYT.js";import{S as Q,a as U}from"./SearchUtil-sOWd6ofa.js";import{a as z}from"./app-duU6O0cq.js";import{f as W}from"./DateUtil-BI1mUH_z.js";import{p as X,q as N}from"./PromQueryUtil-2EbGMcmH.js";import{b as Z}from"./ByteUtil-YdHlSEeW.js";import"./request-8jI_GZey.js";const ee={class:"__container_app_instance"},te={class:"statistic-icon-big"},ae=$({__name:"instance",setup(se){var C;M(i=>({"4b565263":r(g)+"22","7b2014ad":r(g)}));const T=B(),E=Y();let R=x({info:{},report:{}}),O=(C=T.params)==null?void 0:C.pathId;S(async()=>{});const A=[{title:"instanceDomain.ip",dataIndex:"ip",key:"ip",sorter:!0,width:150,fixed:"left"},{title:"instanceDomain.name",dataIndex:"name",key:"name",sorter:!0,width:180},{title:"instanceDomain.deployState",dataIndex:"deployState",key:"deployState",sorter:!0,width:150},{title:"instanceDomain.deployCluster",dataIndex:"deployClusters",key:"deployClusters",sorter:!0,width:180},{title:"instanceDomain.registerState",dataIndex:"registerState",key:"registerState",sorter:!0,width:150},{title:"instanceDomain.registerClusters",dataIndex:"registerCluster",key:"registerCluster",sorter:!0,width:200},{title:"instanceDomain.cpu",dataIndex:"cpu",key:"cpu",sorter:!0,width:120},{title:"instanceDomain.memory",dataIndex:"memory",key:"memory",sorter:!0,width:120},{title:"instanceDomain.startTime",dataIndex:"startTime",key:"startTime",sorter:!0,width:150}];function V(i){return z(i).then(async k=>X(k,["cpu","memory"],async p=>{let u=p.ip.split(":")[0],_=await N(`sum(node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate{container!=""}) by (pod) * on (pod) group_left(pod_ip)
        kube_pod_info{pod_ip="${u}"}`),b=await N(`sum(container_memory_working_set_bytes{container!=""}) by (pod)
* on (pod) group_left(pod_ip)
kube_pod_info{pod_ip="${u}"}`);p.cpu=j.isNumber(_)?_.toFixed(3)+"u":_,p.memory=Z(b)}))}const f=x(new Q([{label:"",param:"type",defaultValue:1,dict:[{label:"ip",value:1},{label:"name",value:2},{label:"label",value:3}],style:{width:"100px"}},{label:"",param:"search",style:{width:"300px"}},{label:"",param:"appName",defaultValue:O,dict:[],dictType:"APPLICATION_NAME"}],V,A,{pageSize:10},!0));S(()=>{f.tableStyle={scrollX:"100",scrollY:"calc(100vh - 400px)"},f.onSearch()});const L=i=>{E.replace(`/resources/instances/detail/${i.split(":")[0]}/${i}`)};return F(J.SEARCH_DOMAIN,f),(i,k)=>{const p=y("a-statistic"),u=y("a-flex"),_=y("a-card"),b=y("a-button"),m=y("a-tag");return a(),I("div",ee,[d(u,{wrap:"wrap",gap:"small",vertical:!1,justify:"space-around",align:"left"},{default:t(()=>[(a(!0),I(h,null,D(r(R).report,(s,e)=>(a(),l(_,{class:"statistic-card"},{default:t(()=>[d(u,{gap:"middle",vertical:!1,justify:"space-between",align:"center"},{default:t(()=>[d(p,{value:s.value,class:"statistic"},{prefix:t(()=>[d(r(v),{class:"statistic-icon",icon:"solar:target-line-duotone"})]),title:t(()=>[n(o(i.$t(e.toString())),1)]),_:2},1032,["value"]),q("div",te,[d(r(v),{icon:s.icon},null,8,["icon"])])]),_:2},1024)]),_:2},1024))),256))]),_:1}),d(U,{"search-domain":f},{bodyCell:t(({column:s,text:e})=>[s.dataIndex==="name"?(a(),l(b,{key:0,type:"link",onClick:w=>L(e)},{default:t(()=>[n(o(e),1)]),_:2},1032,["onClick"])):c("",!0),s.dataIndex==="deployState"?(a(),l(m,{key:1,color:r(G)[e.toUpperCase()]},{default:t(()=>[n(o(e),1)]),_:2},1032,["color"])):c("",!0),s.dataIndex==="deployClusters"?(a(),l(m,{key:2},{default:t(()=>[n(o(e),1)]),_:2},1024)):c("",!0),s.dataIndex==="registerState"?(a(),l(m,{key:3,color:r(H)[e.toUpperCase()]},{default:t(()=>[n(o(e),1)]),_:2},1032,["color"])):c("",!0),s.dataIndex==="registerCluster"?(a(),l(m,{key:4},{default:t(()=>[n(o(e),1)]),_:2},1024)):c("",!0),s.dataIndex==="labels"?(a(!0),I(h,{key:5},D(e,(w,P)=>(a(),l(m,{color:r(g)},{default:t(()=>[n(o(P)+" : "+o(w),1)]),_:2},1032,["color"]))),256)):c("",!0),s.dataIndex==="registerTime"?(a(),I(h,{key:6},[n(o(r(W)(e)),1)],64)):c("",!0)]),_:1},8,["search-domain"])])}}}),pe=K(ae,[["__scopeId","data-v-de9e0d35"]]);export{pe as default};
