import{u as Ue}from"./index-Va7nxJVK.js";import{d as De,x as Re,y as Ke,W as qe,F as Oe,k as je,a as Ee,z as W,r as Se,D as se,c as F,b as t,w as l,e as O,o as h,f as C,G as b,n as E,a9 as Ae,aa as me,Q as j,J as L,K as X,j as G,t as S,I as A,m as Ve,p as ze,h as Ge,_ as Be}from"./index-hmLAZQYT.js";import{g as Pe,u as Ne}from"./traffic-C2a-KjHH.js";import"./request-8jI_GZey.js";const J=Y=>(ze("data-v-03458e68"),Y=Y(),Ge(),Y),We={class:"__container_routingRule_detail"},xe={style:{"max-width":"400px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},Fe=J(()=>G("br",null,null,-1)),Je=J(()=>G("br",null,null,-1)),Le=J(()=>G("br",null,null,-1)),Ye=J(()=>G("br",null,null,-1)),Qe=J(()=>G("br",null,null,-1)),He=J(()=>G("br",null,null,-1)),Xe=De({__name:"updateByFormView",setup(Y){const P=Re(Ke.PROVIDE_INJECT_KEY);qe(async()=>{if(Oe.isNil(P.conditionRule))await ae();else{const{enabled:s=!0,key:e,scope:i,runtime:f=!0,conditions:M}=P.conditionRule;console.log("[ TAB_STATE.conditionRule ] >",P.conditionRule),_.enable=s,_.objectOfAction=e,_.ruleGranularity=i,_.runtime=f,M&&M.length&&M.forEach((d,n)=>{var v,R;const k=d.split("=>"),o=(v=k[0])==null?void 0:v.trim(),$=(R=k[1])==null?void 0:R.trim();c.value[n].requestMatch=te(o,n),c.value[n].routeDistribute=le($,n)})}we()}),je();const Q=Ee(),x=W(!1),Z=W(8);Ue().toClipboard;const _=Se({version:"",ruleGranularity:"",objectOfAction:"",enable:!0,faultTolerantProtection:!1,runtime:!0,priority:null,group:""});se(_,s=>{const{ruleGranularity:e,enable:i=!0,runtime:f=!0,objectOfAction:M}=s;P.conditionRule={...P.conditionRule,enabled:i,key:M,runtime:f,scope:e}});const oe=W([{label:"host",value:"host"},{label:"application",value:"application"},{label:"method",value:"method"},{label:"arguments",value:"arguments"},{label:"attachments",value:"attachments"},{label:"其他",value:"other"}]),ie=W([{label:"host",value:"host"},{label:"其他",value:"other"}]),B=W([{label:"=",value:"="},{label:"!=",value:"!="}]),ue=W([{label:"应用",value:"application"},{label:"服务",value:"service"}]),c=W([{selectedMatchConditionTypes:[],requestMatch:[],selectedRouteDistributeMatchTypes:[],routeDistribute:[{type:"host",condition:"=",value:"127.0.0.1"},{type:"other",list:[{myKey:"key",condition:"=",value:"value"}]}]}]);se(c,s=>{P.conditionRule={...P.conditionRule,conditions:ne()}},{deep:!0});const ce=()=>{c.value.push({selectedMatchConditionTypes:[],requestMatch:[],selectedRouteDistributeMatchTypes:[],routeDistribute:[{type:"host",condition:"=",value:"127.0.0.1"},{type:"other",list:[{myKey:"key",condition:"=",value:"value"}]}]})},de=s=>{c.value.splice(s,1)},re=s=>{c.value[s].requestMatch=[],c.value[s].selectedMatchConditionTypes=[]},pe=s=>{c.value[s].requestMatch=[{type:"host",condition:"",value:""},{type:"application",condition:"",value:""},{type:"method",condition:"",value:""},{type:"arguments",list:[{index:0,condition:"",value:""}]},{type:"attachments",list:[{myKey:"key",condition:"",value:""}]},{type:"other",list:[{myKey:"key",condition:"",value:""}]}]},H=(s,e)=>{c.value[e].selectedMatchConditionTypes=c.value[e].selectedMatchConditionTypes.filter(i=>i!==s)},ve=(s,e)=>{c.value[e].selectedRouteDistributeMatchTypes=c.value[e].selectedRouteDistributeMatchTypes.filter(i=>i!==s)},ye=[{dataIndex:"index",key:"index",title:"参数索引"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],he=(s,e)=>{c.value[s].requestMatch[e].list.push({index:0,condition:"=",value:""})},fe=(s,e,i)=>{c.value[s].requestMatch[e].list.length===1&&(c.value[s].selectedMatchConditionTypes=c.value[s].selectedMatchConditionTypes.filter(f=>f!=="arguments")),c.value[s].requestMatch[e].list.splice(i,1)},_e=[{dataIndex:"myKey",key:"myKey",title:"键"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],ke=(s,e)=>{c.value[s].requestMatch[e].list.push({key:"key",condition:"=",value:""})},be=(s,e,i)=>{c.value[s].requestMatch[e].list.length===1&&(c.value[s].selectedMatchConditionTypes=c.value[s].selectedMatchConditionTypes.filter(f=>f!=="attachments")),c.value[s].requestMatch[e].list.splice(i,1)},I=[{dataIndex:"myKey",key:"myKey",title:"键"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],ge=(s,e)=>{c.value[s].requestMatch[e].list.push({myKey:"",condition:"=",value:""})},Ce=(s,e,i)=>{if(c.value[s].requestMatch[e].list.length===1){c.value[s].selectedMatchConditionTypes=c.value[s].selectedMatchConditionTypes.filter(f=>f!=="other");return}c.value[s].requestMatch[e].list.splice(i,1)},Me=(s,e)=>{c.value[s].routeDistribute[e].list.push({myKey:"",condition:"=",value:""})},$e=(s,e,i)=>{if(c.value[s].routeDistribute[e].list.length===1){c.value[s].selectedRouteDistributeMatchTypes=c.value[s].selectedRouteDistributeMatchTypes.filter(f=>f!=="other");return}c.value[s].routeDistribute[e].list.splice(i,1)},ee=s=>{var v,R;const e=c.value[s],{ruleGranularity:i,objectOfAction:f}=_;let d=`对于${i==="service"?"服务":"应用"}【${f||"未指定"}】`,n=[];(v=e.selectedMatchConditionTypes)==null||v.forEach(T=>{var V,N,p,g;const w=(V=e.requestMatch)==null?void 0:V.find(a=>a.type===T);if(!w)return;let y="";const q=w.condition==="="?"等于":w.condition==="!="?"不等于":w.condition||"",m=w.value||"未指定";switch(T){case"host":y=`请求来源主机 ${q} ${m}`;break;case"application":y=`请求来源应用 ${q} ${m}`;break;case"method":y=`请求方法 ${q} ${m}`;break;case"arguments":const a=(N=w.list)==null?void 0:N.map(u=>{const z=u.condition==="="?"等于":u.condition==="!="?"不等于":u.condition||"",K=u.value!==void 0&&u.value!==""?u.value:"未指定";return`参数[${u.index}] ${z} ${K}`}).filter(Boolean);(a==null?void 0:a.length)>0&&(y=a.join(" 且 "));break;case"attachments":const U=(p=w.list)==null?void 0:p.map(u=>{const z=u.condition==="="?"等于":u.condition==="!="?"不等于":u.condition||"",K=u.value!==void 0&&u.value!==""?u.value:"未指定";return`附件[${u.myKey||"未指定"}] ${z} ${K}`}).filter(Boolean);(U==null?void 0:U.length)>0&&(y=U.join(" 且 "));break;case"other":const r=(g=w.list)==null?void 0:g.map(u=>{const z=u.condition==="="?"等于":u.condition==="!="?"不等于":u.condition||"",K=u.value!==void 0&&u.value!==""?u.value:"未指定";return`自定义匹配[${u.myKey||"未指定"}] ${z} ${K}`}).filter(Boolean);(r==null?void 0:r.length)>0&&(y=r.join(" 且 "));break}y&&((T==="host"||T==="application"||T==="method")&&!w.value?n.push(`${T==="host"?"请求来源主机":T==="application"?"请求来源应用":"请求方法"} 未填写`):n.push(y))});const k=n.length>0?n.join(" 且 "):"任意请求";let o=[];(R=e.selectedRouteDistributeMatchTypes)==null||R.forEach(T=>{var V,N;const w=(V=e.routeDistribute)==null?void 0:V.find(p=>p.type===T);if(!w)return;let y="";const q=w.condition==="="?"等于":w.condition==="!="?"不等于":w.condition||"",m=w.value||"未指定";switch(T){case"host":y=`目标主机 ${q} ${m}`;break;case"other":const p=(N=w.list)==null?void 0:N.map(g=>{const a=g.condition==="="?"等于":g.condition==="!="?"不等于":g.condition||"",U=g.value!==void 0&&g.value!==""?g.value:"未指定";return`目标标签[${g.myKey||"未指定"}] ${a} ${U}`}).filter(Boolean);(p==null?void 0:p.length)>0&&(y=p.join(" 且 "));break}y&&(T==="host"&&!w.value?o.push("目标主机 未填写"):o.push(y))});const $=o.length>0?`满足 【${o.join(" 且 ")}】`:"默认路由规则";return`${d}，将满足 【${k}】 条件的请求，转发到 ${$} 的实例。`};function te(s,e){const i=[],f=s.split(" & ");return[{type:"host",condition:"",value:""},{type:"application",condition:"",value:""},{type:"method",condition:"",value:""},{type:"arguments",list:[]},{type:"attachments",list:[]},{type:"other",list:[]}].forEach(d=>i.push({...d})),f.forEach(d=>{if(d=d.trim(),d.startsWith("host")){c.value[e].selectedMatchConditionTypes.push("host");const n=d.match(/^host(!=|=)(.+)/);if(n){const k=n[1],o=n[2].trim(),$=i.find(v=>v.type==="host");$.condition=k,$.value=o}}else if(d.startsWith("application")){c.value[e].selectedMatchConditionTypes.push("application");const n=d.match(/^application(!=|=)(.+)/);if(n){const k=n[1],o=n[2].trim(),$=i.find(v=>v.type==="application");$.condition=k,$.value=o}}else if(d.startsWith("method")){c.value[e].selectedMatchConditionTypes.push("method");const n=d.match(/^method(!=|=)(.+)/);if(n){const k=n[1],o=n[2].trim(),$=i.find(v=>v.type==="method");$.condition=k,$.value=o}}else if(d.startsWith("arguments")){!c.value[e].selectedMatchConditionTypes.includes("arguments")&&c.value[e].selectedMatchConditionTypes.push("arguments");const n=d.match(/^arguments\[(\d+)\](!=|=)(.+)/);if(n){const k=parseInt(n[1],10),o=n[2],$=n[3].trim();i.find(R=>R.type==="arguments").list.push({index:k,condition:o,value:$})}}else if(d.startsWith("attachments")){!c.value[e].selectedMatchConditionTypes.includes("attachments")&&c.value[e].selectedMatchConditionTypes.push("attachments");const n=d.match(/^attachments\[(.+)\](!=|=)(.+)/);if(n){const k=n[1].trim(),o=n[2],$=n[3].trim();i.find(R=>R.type==="attachments").list.push({myKey:k,condition:o,value:$})}}else{const n=d.match(/^([^!=]+)(!?=)(.+)$/);if(n){!c.value[e].selectedMatchConditionTypes.includes("other")&&c.value[e].selectedMatchConditionTypes.push("other");const k=i.find(o=>o.type==="other");k&&k.list.push({myKey:n[1].trim(),condition:n[2],value:n[3].trim()})}}}),i}function le(s,e){const i=[],f=s==null?void 0:s.split(" & ");return[{type:"host",condition:"",value:""},{type:"other",list:[]}].forEach(d=>i.push({...d})),f!=null&&f.length&&f.forEach(d=>{if(d=d.trim(),d.startsWith("host")){c.value[e].selectedRouteDistributeMatchTypes.push("host");const n=d.match(/^host(!=|=)(.+)/);if(n){const k=n[1],o=n[2].trim(),$=i.find(v=>v.type==="host");$.condition=k,$.value=o}}else{const n=d.match(/^([^!=]+)(!?=)(.+)$/);if(n){!c.value[e].selectedRouteDistributeMatchTypes.includes("other")&&c.value[e].selectedRouteDistributeMatchTypes.push("other");const k=i.find(o=>o.type==="other");k&&k.list.push({myKey:n[1].trim(),condition:n[2],value:n[3].trim()})}}}),i}async function ae(){var e;let s=await Pe((e=Q.params)==null?void 0:e.ruleName);if((s==null?void 0:s.code)===200){console.log("res",s.data);const{conditions:i,configVersion:f,enabled:M,force:d,key:n,runtime:k,scope:o}=s==null?void 0:s.data;_.ruleGranularity=o,_.objectOfAction=n,_.enable=M,_.faultTolerantProtection=d,_.runtime=k,_.configVersion=f,f=="v3.0"&&i.forEach(($,v)=>{var y,q;const R=$.split("=>"),T=(y=R[0])==null?void 0:y.trim(),w=(q=R[1])==null?void 0:q.trim();c.value[v].requestMatch=te(T,v),c.value[v].routeDistribute=le(w,v)})}}function ne(){let s=[],e="",i="";return c.value.forEach((f,M)=>{f.selectedMatchConditionTypes.forEach((n,k)=>{f.requestMatch.forEach((o,$)=>{if(n==(o==null?void 0:o.type))switch(o==null?void 0:o.type){case"arguments":o.list.forEach((v,R)=>{e.length>0&&(e+=" & "),e+=`${n}[${v.index}]${v.condition}${v.value}`});break;case"attachments":o.list.forEach((v,R)=>{e.length>0&&(e+=" & "),e+=`${n}[${v.myKey}]${v.condition}${v.value}`});break;case"other":o.list.forEach((v,R)=>{e.length>0&&(e+=" & "),e+=`${v.myKey}${v.condition}${v.value}`});break;default:e.length>0&&(e+=" & "),e+=`${o.type}${o.condition}${o.value}`}})}),f.selectedRouteDistributeMatchTypes.forEach((n,k)=>{f.routeDistribute.forEach((o,$)=>{if(n==(o==null?void 0:o.type))switch(o==null?void 0:o.type){case"other":o==null||o.list.forEach((v,R)=>{i.length>0&&(i+=" & "),i+=`${v.myKey}${v.condition}${v.value}`});break;default:i.length>0&&(i+=" & "),i+=`${o.type}${o.condition}${o.value}`}})});let d="";e.length>0&&i.length>0?d=`${e} => ${i}`:e.length>0&&i.length==0&&(d=`${e}`),s.push(d)}),s}const Te=async()=>{const{ruleName:s}=Q.params,{version:e,ruleGranularity:i,objectOfAction:f,enable:M,faultTolerantProtection:d,runtime:n}=_,k={configVersion:"v3.0",scope:i,key:f,enabled:M,force:d,runtime:n,conditions:ne()},o=await Ne(s,k);(o==null?void 0:o.code)===200&&(await ae(),Ve.success("修改成功"))},we=()=>{var e;const s=(e=Q.params)==null?void 0:e.ruleName;if(s&&_.ruleGranularity==="service"){const i=s==null?void 0:s.split(":");_.version=i[1],_.group=i[2].split(".")[0]}};return(s,e)=>{const i=O("a-button"),f=O("a-flex"),M=O("a-select"),d=O("a-form-item"),n=O("a-input"),k=O("a-switch"),o=O("a-col"),$=O("a-input-number"),v=O("a-row"),R=O("a-form"),T=O("a-card"),w=O("a-tooltip"),y=O("a-space"),q=O("a-tag"),m=O("a-table"),V=O("a-descriptions-item"),N=O("a-descriptions");return h(),F("div",We,[t(f,{style:{width:"100%"}},{default:l(()=>[t(o,{span:x.value?24-Z.value:24,class:"left"},{default:l(()=>[t(T,null,{default:l(()=>[t(y,{style:{width:"100%"},direction:"vertical",size:"middle"},{default:l(()=>[t(v,null,{default:l(()=>[t(f,{justify:"end",style:{width:"100%"}},{default:l(()=>[t(i,{type:"text",style:{color:"#0a90d5"},onClick:e[0]||(e[0]=p=>x.value=!x.value)},{default:l(()=>[C(" 字段说明 "),x.value?(h(),b(E(me),{key:1})):(h(),b(E(Ae),{key:0}))]),_:1})]),_:1}),t(T,{title:"基础信息",style:{width:"100%"},class:"_detail"},{default:l(()=>[t(R,{layout:"horizontal"},{default:l(()=>[t(v,{style:{width:"100%"}},{default:l(()=>[t(o,{span:12},{default:l(()=>[t(d,{label:"规则粒度",required:""},{default:l(()=>[t(M,{disabled:"",value:_.ruleGranularity,"onUpdate:value":e[1]||(e[1]=p=>_.ruleGranularity=p),style:{width:"120px"},options:ue.value},null,8,["value","options"])]),_:1}),_.ruleGranularity==="service"?(h(),b(d,{key:0,label:"版本",required:""},{default:l(()=>[t(n,{value:_.version,"onUpdate:value":e[2]||(e[2]=p=>_.version=p),style:{width:"300px"},disabled:""},null,8,["value"])]),_:1})):j("",!0),t(d,{label:"容错保护"},{default:l(()=>[t(k,{checked:_.faultTolerantProtection,"onUpdate:checked":e[3]||(e[3]=p=>_.faultTolerantProtection=p),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),t(d,{label:"运行时生效"},{default:l(()=>[t(k,{checked:_.runtime,"onUpdate:checked":e[4]||(e[4]=p=>_.runtime=p),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})]),_:1}),t(o,{span:12},{default:l(()=>[t(d,{label:"作用对象",required:""},{default:l(()=>[t(n,{disabled:"",value:_.objectOfAction,"onUpdate:value":e[5]||(e[5]=p=>_.objectOfAction=p),style:{width:"300px"}},null,8,["value"])]),_:1}),_.ruleGranularity==="service"?(h(),b(d,{key:0,label:"分组",required:""},{default:l(()=>[t(n,{value:_.group,"onUpdate:value":e[6]||(e[6]=p=>_.group=p),style:{width:"300px"},disabled:""},null,8,["value"])]),_:1})):j("",!0),t(d,{label:"立即启用"},{default:l(()=>[t(k,{checked:_.enable,"onUpdate:checked":e[7]||(e[7]=p=>_.enable=p),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),t(d,{label:"优先级"},{default:l(()=>[t($,{value:_.priority,"onUpdate:value":e[8]||(e[8]=p=>_.priority=p),min:"1"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(T,{title:"路由列表",style:{width:"100%"},class:"_detail"},{default:l(()=>[(h(!0),F(L,null,X(c.value,(p,g)=>(h(),b(T,null,{title:l(()=>[t(f,{justify:"space-between"},{default:l(()=>[t(y,{align:"center"},{default:l(()=>[G("div",null,"路由【"+S(g+1)+"】",1),t(w,null,{title:l(()=>[C(S(ee(g)),1)]),default:l(()=>[G("div",xe,S(ee(g)),1)]),_:2},1024)]),_:2},1024),t(E(A),{onClick:a=>de(g),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)]),default:l(()=>[t(R,{layout:"horizontal"},{default:l(()=>[t(y,{style:{width:"100%"},direction:"vertical",size:"large"},{default:l(()=>[t(d,{label:"请求匹配"},{default:l(()=>[p.requestMatch.length>0?(h(),b(T,{key:0},{default:l(()=>[t(y,{style:{width:"100%"},direction:"vertical",size:"small"},{default:l(()=>[t(f,{align:"center",justify:"space-between"},{default:l(()=>[t(d,{label:"匹配条件类型"},{default:l(()=>[t(M,{value:p.selectedMatchConditionTypes,"onUpdate:value":a=>p.selectedMatchConditionTypes=a,options:oe.value,mode:"multiple",style:{"min-width":"200px"}},null,8,["value","onUpdate:value","options"])]),_:2},1024),t(E(A),{onClick:a=>re(g),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024),(h(!0),F(L,null,X(p.requestMatch,(a,U)=>(h(),F(L,null,[p.selectedMatchConditionTypes.includes("host")&&a.type==="host"?(h(),b(y,{key:0,size:"large",align:"center"},{default:l(()=>[t(q,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[C(S(a==null?void 0:a.type),1)]),_:2},1024),t(M,{value:a.condition,"onUpdate:value":r=>a.condition=r,style:{"min-width":"120px"},options:B.value},null,8,["value","onUpdate:value","options"]),t(n,{value:a.value,"onUpdate:value":r=>a.value=r,placeholder:"请求来源ip"},null,8,["value","onUpdate:value"]),t(E(A),{onClick:r=>H(a==null?void 0:a.type,g),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):j("",!0),p.selectedMatchConditionTypes.includes("application")&&a.type==="application"?(h(),b(y,{key:1,size:"large",align:"center"},{default:l(()=>[t(q,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[C(S(a==null?void 0:a.type),1)]),_:2},1024),t(M,{value:a.condition,"onUpdate:value":r=>a.condition=r,style:{"min-width":"120px"},options:B.value},null,8,["value","onUpdate:value","options"]),t(n,{value:a.value,"onUpdate:value":r=>a.value=r,placeholder:"请求来源应用名"},null,8,["value","onUpdate:value"]),t(E(A),{onClick:r=>H(a==null?void 0:a.type,g),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):j("",!0),p.selectedMatchConditionTypes.includes("method")&&a.type==="method"?(h(),b(y,{key:2,size:"large",align:"center"},{default:l(()=>[t(q,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[C(S(a==null?void 0:a.type),1)]),_:2},1024),t(M,{value:a.condition,"onUpdate:value":r=>a.condition=r,style:{"min-width":"120px"},options:B.value},null,8,["value","onUpdate:value","options"]),t(n,{value:a.value,"onUpdate:value":r=>a.value=r,placeholder:"方法值"},null,8,["value","onUpdate:value"]),t(E(A),{onClick:r=>H(a==null?void 0:a.type,g),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):j("",!0),p.selectedMatchConditionTypes.includes("arguments")&&a.type==="arguments"?(h(),b(y,{key:3,style:{width:"100%"},size:"large",align:"start"},{default:l(()=>[t(q,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[C(S(a==null?void 0:a.type),1)]),_:2},1024),t(y,{direction:"vertical"},{default:l(()=>[t(i,{type:"primary",onClick:r=>he(g,U)},{default:l(()=>[C(" 添加argument ")]),_:2},1032,["onClick"]),t(m,{pagination:!1,columns:ye,"data-source":p.requestMatch[U].list},{bodyCell:l(({column:r,record:u,text:z,index:K})=>[r.key==="index"?(h(),b(n,{key:0,value:u.index,"onUpdate:value":D=>u.index=D,placeholder:"index"},null,8,["value","onUpdate:value"])):r.key==="condition"?(h(),b(M,{key:1,value:u.condition,"onUpdate:value":D=>u.condition=D,options:B.value},null,8,["value","onUpdate:value","options"])):r.key==="value"?(h(),b(n,{key:2,value:u.value,"onUpdate:value":D=>u.value=D,placeholder:"value"},null,8,["value","onUpdate:value"])):r.key==="operation"?(h(),b(y,{key:3,align:"center"},{default:l(()=>[t(E(A),{onClick:D=>fe(g,U,K),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):j("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):j("",!0),p.selectedMatchConditionTypes.includes("attachments")&&a.type==="attachments"?(h(),b(y,{key:4,style:{width:"100%"},size:"large",align:"start"},{default:l(()=>[t(q,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[C(S(a==null?void 0:a.type),1)]),_:2},1024),t(y,{direction:"vertical"},{default:l(()=>[t(i,{type:"primary",onClick:r=>ke(g,U)},{default:l(()=>[C(" 添加attachment ")]),_:2},1032,["onClick"]),t(m,{pagination:!1,columns:_e,"data-source":p.requestMatch[U].list},{bodyCell:l(({column:r,record:u,text:z,index:K})=>[r.key==="myKey"?(h(),b(n,{key:0,value:u.myKey,"onUpdate:value":D=>u.myKey=D,placeholder:"key"},null,8,["value","onUpdate:value"])):r.key==="condition"?(h(),b(M,{key:1,value:u.condition,"onUpdate:value":D=>u.condition=D,options:B.value},null,8,["value","onUpdate:value","options"])):r.key==="value"?(h(),b(n,{key:2,value:u.value,"onUpdate:value":D=>u.value=D,placeholder:"value"},null,8,["value","onUpdate:value"])):r.key==="operation"?(h(),b(y,{key:3,align:"center"},{default:l(()=>[t(E(A),{onClick:D=>be(g,U,K),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):j("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):j("",!0),p.selectedMatchConditionTypes.includes("other")&&a.type==="other"?(h(),b(y,{key:5,style:{width:"100%"},size:"large",align:"start"},{default:l(()=>[t(q,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[C(S((a==null?void 0:a.type)=="other"?"其他":a==null?void 0:a.type),1)]),_:2},1024),t(y,{direction:"vertical"},{default:l(()=>[t(i,{type:"primary",onClick:r=>ge(g,U)},{default:l(()=>[C(" 添加other ")]),_:2},1032,["onClick"]),t(m,{pagination:!1,columns:I,"data-source":p.requestMatch[U].list},{bodyCell:l(({column:r,record:u,text:z})=>[r.key==="myKey"?(h(),b(n,{key:0,value:u.myKey,"onUpdate:value":K=>u.myKey=K,placeholder:"key"},null,8,["value","onUpdate:value"])):r.key==="condition"?(h(),b(M,{key:1,value:u.condition,"onUpdate:value":K=>u.condition=K,options:B.value},null,8,["value","onUpdate:value","options"])):r.key==="value"?(h(),b(n,{key:2,value:u.value,"onUpdate:value":K=>u.value=K,placeholder:"value"},null,8,["value","onUpdate:value"])):r.key==="operation"?(h(),b(y,{key:3,align:"center"},{default:l(()=>[t(E(A),{onClick:K=>Ce(g,U,u.index),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):j("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):j("",!0)],64))),256))]),_:2},1024)]),_:2},1024)):(h(),b(i,{key:1,onClick:a=>pe(g),type:"dashed",size:"large"},{icon:l(()=>[t(E(A),{icon:"tdesign:add"})]),default:l(()=>[C(" 增加匹配条件 ")]),_:2},1032,["onClick"]))]),_:2},1024),t(d,{label:"路由分发",required:""},{default:l(()=>[t(T,null,{default:l(()=>[t(y,{style:{width:"100%"},direction:"vertical",size:"small"},{default:l(()=>[t(f,null,{default:l(()=>[t(d,{label:"匹配条件类型"},{default:l(()=>[t(M,{value:p.selectedRouteDistributeMatchTypes,"onUpdate:value":a=>p.selectedRouteDistributeMatchTypes=a,options:ie.value,mode:"multiple",style:{"min-width":"200px"}},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024),(h(!0),F(L,null,X(p.routeDistribute,(a,U)=>(h(),F(L,{key:U},[p.selectedRouteDistributeMatchTypes.includes("host")&&a.type==="host"?(h(),b(y,{key:0,size:"large",align:"center"},{default:l(()=>[t(q,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[C(S(a==null?void 0:a.type),1)]),_:2},1024),t(M,{value:a.condition,"onUpdate:value":r=>a.condition=r,style:{"min-width":"120px"},options:B.value},null,8,["value","onUpdate:value","options"]),t(n,{value:a.value,"onUpdate:value":r=>a.value=r,placeholder:"请求来源ip"},null,8,["value","onUpdate:value"]),t(E(A),{onClick:r=>ve(a==null?void 0:a.type,g),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):j("",!0),p.selectedRouteDistributeMatchTypes.includes("other")&&a.type==="other"?(h(),b(y,{key:1,style:{width:"100%"},size:"large",align:"start"},{default:l(()=>[t(q,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[C(S((a==null?void 0:a.type)=="other"?"其他":a==null?void 0:a.type),1)]),_:2},1024),t(y,{direction:"vertical"},{default:l(()=>[t(i,{type:"primary",onClick:r=>Me(g,U)},{default:l(()=>[C(" 添加其他 ")]),_:2},1032,["onClick"]),t(m,{pagination:!1,columns:I,"data-source":p.routeDistribute[U].list},{bodyCell:l(({column:r,record:u,text:z,index:K})=>[r.key==="myKey"?(h(),b(n,{key:0,value:u.myKey,"onUpdate:value":D=>u.myKey=D,placeholder:"key"},null,8,["value","onUpdate:value"])):r.key==="condition"?(h(),b(M,{key:1,value:u.condition,"onUpdate:value":D=>u.condition=D,options:B.value},null,8,["value","onUpdate:value","options"])):r.key==="value"?(h(),b(n,{key:2,value:u.value,"onUpdate:value":D=>u.value=D,placeholder:"value"},null,8,["value","onUpdate:value"])):r.key==="operation"?(h(),b(y,{key:3,align:"center"},{default:l(()=>[t(E(A),{onClick:D=>$e(g,U,K),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):j("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):j("",!0)],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),t(i,{onClick:ce,type:"primary"},{default:l(()=>[C(" 增加路由")]),_:1})]),_:1})]),_:1})]),_:1},8,["span"]),t(o,{span:x.value?Z.value:0,class:"right"},{default:l(()=>[x.value?(h(),b(T,{key:0,class:"sliderBox"},{default:l(()=>[G("div",null,[t(N,{title:"字段说明",column:1},{default:l(()=>[t(V,{label:"key"},{default:l(()=>[C(" 作用对象"),Fe,C(" 可能的值：Dubbo应用名或者服务名 ")]),_:1}),t(V,{label:"scope"},{default:l(()=>[C(" 规则粒度"),Je,C(" 可能的值：application, service ")]),_:1}),t(V,{label:"force"},{default:l(()=>[C(" 容错保护"),Le,C(" 可能的值：true, false"),Ye,C(" 描述：如果为true，则路由筛选后若没有可用的地址则会直接报异常；如果为false，则会从可用地址中选择完成RPC调用 ")]),_:1}),t(V,{label:"runtime"},{default:l(()=>[C(" 运行时生效"),Qe,C(" 可能的值：true, false"),He,C(" 描述：如果为true，则该rule下的所有路由将会实时生效；若为false，则只有在启动时才会生效 ")]),_:1})]),_:1})])]),_:1})):j("",!0)]),_:1},8,["span"])]),_:1}),t(T,{class:"footer"},{default:l(()=>[t(f,null,{default:l(()=>[t(i,{type:"primary",onClick:Te},{default:l(()=>[C("确认")]),_:1}),t(i,{style:{"margin-left":"30px"},onClick:e[9]||(e[9]=p=>console.log(c.value))},{default:l(()=>[C(" 取消")]),_:1})]),_:1})]),_:1})])}}}),lt=Be(Xe,[["__scopeId","data-v-03458e68"]]);export{lt as default};
